{"ast":null,"code":"import{jsxs as _jsxs}from\"react/jsx-runtime\";import{jsx as _jsx}from\"react/jsx-runtime\";import _objectSpread from\"F:/mern/udemy/ecommerce/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _slicedToArray from\"F:/mern/udemy/ecommerce/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState,useEffect}from\"react\";import{useSelector,useDispatch}from\"react-redux\";import{toast}from\"react-toastify\";import DatePicker from\"react-datepicker\";import{getCoupons,removeCoupon,createCoupon}from\"../../../functions/coupon\";import\"react-datepicker/dist/react-datepicker.css\";import{DeleteOutlined}from\"@ant-design/icons\";import AdminNav from\"../../../components/nav/AdminNav\";var CreateCouponPage=function CreateCouponPage(){var _useState=useState(\"\"),_useState2=_slicedToArray(_useState,2),name=_useState2[0],setName=_useState2[1];var _useState3=useState(\"\"),_useState4=_slicedToArray(_useState3,2),expiry=_useState4[0],setExpiry=_useState4[1];var _useState5=useState(\"\"),_useState6=_slicedToArray(_useState5,2),discount=_useState6[0],setDiscount=_useState6[1];var _useState7=useState(\"\"),_useState8=_slicedToArray(_useState7,2),loading=_useState8[0],setLoading=_useState8[1];var _useState9=useState([]),_useState10=_slicedToArray(_useState9,2),coupons=_useState10[0],setCoupons=_useState10[1];// redux\nvar _useSelector=useSelector(function(state){return _objectSpread({},state);}),user=_useSelector.user;useEffect(function(){loadAllCoupons();},[]);var loadAllCoupons=function loadAllCoupons(){return getCoupons().then(function(res){return setCoupons(res.data);});};var handleSubmit=function handleSubmit(e){e.preventDefault();setLoading(true);// console.table(name, expiry, discount);\ncreateCoupon({name:name,expiry:expiry,discount:discount},user.token).then(function(res){setLoading(false);loadAllCoupons();// load all coupons\nsetName(\"\");setDiscount(\"\");setExpiry(\"\");toast.success(\"\\\"\".concat(res.data.name,\"\\\" is created\"));}).catch(function(err){return console.log(\"create coupon err\",err);});};var handleRemove=function handleRemove(couponId){if(window.confirm(\"Delete?\")){setLoading(true);removeCoupon(couponId,user.token).then(function(res){loadAllCoupons();// load all coupons\nsetLoading(false);toast.error(\"Coupon \\\"\".concat(res.data.name,\"\\\" deleted\"));}).catch(function(err){return console.log(err);});}};return/*#__PURE__*/_jsx(\"div\",{className:\"container-fluid\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"row\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"col-md-2\",children:/*#__PURE__*/_jsx(AdminNav,{})}),/*#__PURE__*/_jsxs(\"div\",{className:\"col-md-10\",children:[loading?/*#__PURE__*/_jsx(\"h4\",{className:\"text-danger\",children:\"Loading...\"}):/*#__PURE__*/_jsx(\"h4\",{children:\"Coupon\"}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleSubmit,children:[/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"text-muted\",children:\"Name\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",className:\"form-control\",onChange:function onChange(e){return setName(e.target.value);},value:name,autoFocus:true,required:true})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"text-muted\",children:\"Discount %\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",className:\"form-control\",onChange:function onChange(e){return setDiscount(e.target.value);},value:discount,required:true})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"text-muted\",children:\"Expiry\"}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(DatePicker,{className:\"form-control\",selected:new Date(),value:expiry,onChange:function onChange(date){return setExpiry(date);},required:true})]}),/*#__PURE__*/_jsx(\"button\",{className:\"btn btn-outline-primary\",children:\"Save\"})]}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsxs(\"h4\",{children:[coupons.length,\" Coupons\"]}),/*#__PURE__*/_jsxs(\"table\",{className:\"table table-bordered\",children:[/*#__PURE__*/_jsx(\"thead\",{className:\"thead-light\",children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{scope:\"col\",children:\"Name\"}),/*#__PURE__*/_jsx(\"th\",{scope:\"col\",children:\"Expiry\"}),/*#__PURE__*/_jsx(\"th\",{scope:\"col\",children:\"Discount\"}),/*#__PURE__*/_jsx(\"th\",{scope:\"col\",children:\"Action\"})]})}),/*#__PURE__*/_jsx(\"tbody\",{children:coupons.map(function(c){return/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"td\",{children:c.name}),/*#__PURE__*/_jsx(\"td\",{children:new Date(c.expiry).toLocaleDateString()}),/*#__PURE__*/_jsxs(\"td\",{children:[c.discount,\"%\"]}),/*#__PURE__*/_jsx(\"td\",{children:/*#__PURE__*/_jsx(DeleteOutlined,{onClick:function onClick(){return handleRemove(c._id);},className:\"text-danger pointer\"})})]},c._id);})})]})]})]})});};export default CreateCouponPage;","map":{"version":3,"sources":["F:/mern/udemy/ecommerce/client/src/pages/admin/coupon/CreateCouponPage.js"],"names":["React","useState","useEffect","useSelector","useDispatch","toast","DatePicker","getCoupons","removeCoupon","createCoupon","DeleteOutlined","AdminNav","CreateCouponPage","name","setName","expiry","setExpiry","discount","setDiscount","loading","setLoading","coupons","setCoupons","state","user","loadAllCoupons","then","res","data","handleSubmit","e","preventDefault","token","success","catch","err","console","log","handleRemove","couponId","window","confirm","error","target","value","Date","date","length","map","c","toLocaleDateString","_id"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from \"react\";\nimport { useSelector, useDispatch } from \"react-redux\";\nimport { toast } from \"react-toastify\";\nimport DatePicker from \"react-datepicker\";\nimport {\n  getCoupons,\n  removeCoupon,\n  createCoupon,\n} from \"../../../functions/coupon\";\nimport \"react-datepicker/dist/react-datepicker.css\";\nimport { DeleteOutlined } from \"@ant-design/icons\";\nimport AdminNav from \"../../../components/nav/AdminNav\";\n\nconst CreateCouponPage = () => {\n  const [name, setName] = useState(\"\");\n  const [expiry, setExpiry] = useState(\"\");\n  const [discount, setDiscount] = useState(\"\");\n  const [loading, setLoading] = useState(\"\");\n  const [coupons, setCoupons] = useState([]);\n\n  // redux\n  const { user } = useSelector((state) => ({ ...state }));\n\n  useEffect(() => {\n    loadAllCoupons();\n  }, []);\n\n  const loadAllCoupons = () => getCoupons().then((res) => setCoupons(res.data));\n\n  const handleSubmit = (e) => {\n    e.preventDefault();\n    setLoading(true);\n    // console.table(name, expiry, discount);\n    createCoupon({ name, expiry, discount }, user.token)\n      .then((res) => {\n        setLoading(false);\n        loadAllCoupons(); // load all coupons\n        setName(\"\");\n        setDiscount(\"\");\n        setExpiry(\"\");\n        toast.success(`\"${res.data.name}\" is created`);\n      })\n      .catch((err) => console.log(\"create coupon err\", err));\n  };\n\n  const handleRemove = (couponId) => {\n    if (window.confirm(\"Delete?\")) {\n      setLoading(true);\n      removeCoupon(couponId, user.token)\n        .then((res) => {\n          loadAllCoupons(); // load all coupons\n          setLoading(false);\n          toast.error(`Coupon \"${res.data.name}\" deleted`);\n        })\n        .catch((err) => console.log(err));\n    }\n  };\n\n  return (\n    <div className=\"container-fluid\">\n      <div className=\"row\">\n        <div className=\"col-md-2\">\n          <AdminNav />\n        </div>\n        <div className=\"col-md-10\">\n          {loading ? (\n            <h4 className=\"text-danger\">Loading...</h4>\n          ) : (\n            <h4>Coupon</h4>\n          )}\n\n          <form onSubmit={handleSubmit}>\n            <div className=\"form-group\">\n              <label className=\"text-muted\">Name</label>\n              <input\n                type=\"text\"\n                className=\"form-control\"\n                onChange={(e) => setName(e.target.value)}\n                value={name}\n                autoFocus\n                required\n              />\n            </div>\n\n            <div className=\"form-group\">\n              <label className=\"text-muted\">Discount %</label>\n              <input\n                type=\"text\"\n                className=\"form-control\"\n                onChange={(e) => setDiscount(e.target.value)}\n                value={discount}\n                required\n              />\n            </div>\n\n            <div className=\"form-group\">\n              <label className=\"text-muted\">Expiry</label>\n              <br />\n              <DatePicker\n                className=\"form-control\"\n                selected={new Date()}\n                value={expiry}\n                onChange={(date) => setExpiry(date)}\n                required\n              />\n            </div>\n\n            <button className=\"btn btn-outline-primary\">Save</button>\n          </form>\n\n          <br />\n\n          <h4>{coupons.length} Coupons</h4>\n\n          <table className=\"table table-bordered\">\n            <thead className=\"thead-light\">\n              <tr>\n                <th scope=\"col\">Name</th>\n                <th scope=\"col\">Expiry</th>\n                <th scope=\"col\">Discount</th>\n                <th scope=\"col\">Action</th>\n              </tr>\n            </thead>\n\n            <tbody>\n              {coupons.map((c) => (\n                <tr key={c._id}>\n                  <td>{c.name}</td>\n                  <td>{new Date(c.expiry).toLocaleDateString()}</td>\n                  <td>{c.discount}%</td>\n                  <td>\n                    <DeleteOutlined\n                      onClick={() => handleRemove(c._id)}\n                      className=\"text-danger pointer\"\n                    />\n                  </td>\n                </tr>\n              ))}\n            </tbody>\n          </table>\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport default CreateCouponPage;\n"]},"metadata":{},"sourceType":"module"}