{"ast":null,"code":"import{jsxs as _jsxs}from\"react/jsx-runtime\";import{jsx as _jsx}from\"react/jsx-runtime\";import _regeneratorRuntime from\"F:/mern/udemy/ecommerce/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"F:/mern/udemy/ecommerce/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"F:/mern/udemy/ecommerce/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import _objectSpread from\"F:/mern/udemy/ecommerce/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import React,{useState,useEffect}from\"react\";import AdminNav from\"../../../components/nav/AdminNav\";import{toast}from\"react-toastify\";import{useSelector}from\"react-redux\";import{getCategories}from\"../../../functions/category\";import{createSub,getSub,removeSub,getSubs}from\"../../../functions/sub\";import{Link}from\"react-router-dom\";import{EditOutlined,DeleteOutlined}from\"@ant-design/icons\";import CategoryForm from\"../../../components/forms/CategoryForm\";import LocalSearch from\"../../../components/forms/LocalSearch\";var SubCreate=function SubCreate(){var _useSelector=useSelector(function(state){return _objectSpread({},state);}),user=_useSelector.user;var _useState=useState(\"\"),_useState2=_slicedToArray(_useState,2),name=_useState2[0],setName=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),loading=_useState4[0],setLoading=_useState4[1];var _useState5=useState([]),_useState6=_slicedToArray(_useState5,2),categories=_useState6[0],setCategories=_useState6[1];var _useState7=useState(\"\"),_useState8=_slicedToArray(_useState7,2),category=_useState8[0],setCategory=_useState8[1];var _useState9=useState([]),_useState10=_slicedToArray(_useState9,2),subs=_useState10[0],setSubs=_useState10[1];// step 1\nvar _useState11=useState(\"\"),_useState12=_slicedToArray(_useState11,2),keyword=_useState12[0],setKeyword=_useState12[1];useEffect(function(){loadCategories();loadSubs();},[]);var loadCategories=function loadCategories(){return getCategories().then(function(c){return setCategories(c.data);});};var loadSubs=function loadSubs(){return getSubs().then(function(s){return setSubs(s.data);});};var handleSubmit=function handleSubmit(e){e.preventDefault();// console.log(name);\nsetLoading(true);createSub({name:name,parent:category},user.token).then(function(res){// console.log(res)\nsetLoading(false);setName(\"\");toast.success(\"\\\"\".concat(res.data.name,\"\\\" is created\"));loadSubs();}).catch(function(err){console.log(err);setLoading(false);if(err.response.status===400)toast.error(err.response.data);});};var handleRemove=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(slug){return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:// let answer = window.confirm(\"Delete?\");\n// console.log(answer, slug);\nif(window.confirm(\"Delete?\")){setLoading(true);removeSub(slug,user.token).then(function(res){setLoading(false);toast.error(\"\".concat(res.data.name,\" deleted\"));loadSubs();}).catch(function(err){if(err.response.status===400){setLoading(false);toast.error(err.response.data);}});}case 1:case\"end\":return _context.stop();}}},_callee);}));return function handleRemove(_x){return _ref.apply(this,arguments);};}();// step 4\nvar searched=function searched(keyword){return function(c){return c.name.toLowerCase().includes(keyword);};};return/*#__PURE__*/_jsx(\"div\",{className:\"container-fluid\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"row\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"col-md-2\",children:/*#__PURE__*/_jsx(AdminNav,{})}),/*#__PURE__*/_jsxs(\"div\",{className:\"col\",children:[loading?/*#__PURE__*/_jsx(\"h4\",{className:\"text-danger\",children:\"Loading..\"}):/*#__PURE__*/_jsx(\"h4\",{children:\"Create sub category\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Parent category\"}),/*#__PURE__*/_jsxs(\"select\",{name:\"category\",className:\"form-control\",onChange:function onChange(e){return setCategory(e.target.value);},children:[/*#__PURE__*/_jsx(\"option\",{children:\"Please select\"}),categories.length>0&&categories.map(function(c){return/*#__PURE__*/_jsx(\"option\",{value:c._id,children:c.name},c._id);})]})]}),/*#__PURE__*/_jsx(CategoryForm,{handleSubmit:handleSubmit,name:name,setName:setName}),/*#__PURE__*/_jsx(LocalSearch,{keyword:keyword,setKeyword:setKeyword}),subs.filter(searched(keyword)).map(function(s){return/*#__PURE__*/_jsxs(\"div\",{className:\"alert alert-secondary\",children:[s.name,/*#__PURE__*/_jsx(\"span\",{onClick:function onClick(){return handleRemove(s.slug);},className:\"btn btn-sm float-right\",children:/*#__PURE__*/_jsx(DeleteOutlined,{className:\"text-danger\"})}),/*#__PURE__*/_jsx(Link,{to:\"/admin/sub/\".concat(s.slug),children:/*#__PURE__*/_jsx(\"span\",{className:\"btn btn-sm float-right\",children:/*#__PURE__*/_jsx(EditOutlined,{className:\"text-warning\"})})})]},s._id);})]})]})});};export default SubCreate;","map":{"version":3,"sources":["F:/mern/udemy/ecommerce/client/src/pages/admin/sub/SubCreate.js"],"names":["React","useState","useEffect","AdminNav","toast","useSelector","getCategories","createSub","getSub","removeSub","getSubs","Link","EditOutlined","DeleteOutlined","CategoryForm","LocalSearch","SubCreate","state","user","name","setName","loading","setLoading","categories","setCategories","category","setCategory","subs","setSubs","keyword","setKeyword","loadCategories","loadSubs","then","c","data","s","handleSubmit","e","preventDefault","parent","token","res","success","catch","err","console","log","response","status","error","handleRemove","slug","window","confirm","searched","toLowerCase","includes","target","value","length","map","_id","filter"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from \"react\";\nimport AdminNav from \"../../../components/nav/AdminNav\";\nimport { toast } from \"react-toastify\";\nimport { useSelector } from \"react-redux\";\nimport { getCategories } from \"../../../functions/category\";\nimport { createSub, getSub, removeSub, getSubs } from \"../../../functions/sub\";\nimport { Link } from \"react-router-dom\";\nimport { EditOutlined, DeleteOutlined } from \"@ant-design/icons\";\nimport CategoryForm from \"../../../components/forms/CategoryForm\";\nimport LocalSearch from \"../../../components/forms/LocalSearch\";\n\nconst SubCreate = () => {\n  const { user } = useSelector((state) => ({ ...state }));\n\n  const [name, setName] = useState(\"\");\n  const [loading, setLoading] = useState(false);\n  const [categories, setCategories] = useState([]);\n  const [category, setCategory] = useState(\"\");\n  const [subs, setSubs] = useState([]);\n  // step 1\n  const [keyword, setKeyword] = useState(\"\");\n\n  useEffect(() => {\n    loadCategories();\n    loadSubs();\n  }, []);\n\n  const loadCategories = () =>\n    getCategories().then((c) => setCategories(c.data));\n\n  const loadSubs = () => getSubs().then((s) => setSubs(s.data));\n\n  const handleSubmit = (e) => {\n    e.preventDefault();\n    // console.log(name);\n    setLoading(true);\n    createSub({ name, parent: category }, user.token)\n      .then((res) => {\n        // console.log(res)\n        setLoading(false);\n        setName(\"\");\n        toast.success(`\"${res.data.name}\" is created`);\n        loadSubs();\n      })\n      .catch((err) => {\n        console.log(err);\n        setLoading(false);\n        if (err.response.status === 400) toast.error(err.response.data);\n      });\n  };\n\n  const handleRemove = async (slug) => {\n    // let answer = window.confirm(\"Delete?\");\n    // console.log(answer, slug);\n    if (window.confirm(\"Delete?\")) {\n      setLoading(true);\n      removeSub(slug, user.token)\n        .then((res) => {\n          setLoading(false);\n          toast.error(`${res.data.name} deleted`);\n          loadSubs();\n        })\n        .catch((err) => {\n          if (err.response.status === 400) {\n            setLoading(false);\n            toast.error(err.response.data);\n          }\n        });\n    }\n  };\n\n  // step 4\n  const searched = (keyword) => (c) => c.name.toLowerCase().includes(keyword);\n\n  return (\n    <div className=\"container-fluid\">\n      <div className=\"row\">\n        <div className=\"col-md-2\">\n          <AdminNav />\n        </div>\n        <div className=\"col\">\n          {loading ? (\n            <h4 className=\"text-danger\">Loading..</h4>\n          ) : (\n            <h4>Create sub category</h4>\n          )}\n\n          <div className=\"form-group\">\n            <label>Parent category</label>\n            <select\n              name=\"category\"\n              className=\"form-control\"\n              onChange={(e) => setCategory(e.target.value)}\n            >\n              <option>Please select</option>\n              {categories.length > 0 &&\n                categories.map((c) => (\n                  <option key={c._id} value={c._id}>\n                    {c.name}\n                  </option>\n                ))}\n            </select>\n          </div>\n\n          <CategoryForm\n            handleSubmit={handleSubmit}\n            name={name}\n            setName={setName}\n          />\n\n          {/* step 2 and step 3 */}\n          <LocalSearch keyword={keyword} setKeyword={setKeyword} />\n\n          {/* step 5 */}\n          {subs.filter(searched(keyword)).map((s) => (\n            <div className=\"alert alert-secondary\" key={s._id}>\n              {s.name}\n              <span\n                onClick={() => handleRemove(s.slug)}\n                className=\"btn btn-sm float-right\"\n              >\n                <DeleteOutlined className=\"text-danger\" />\n              </span>\n              <Link to={`/admin/sub/${s.slug}`}>\n                <span className=\"btn btn-sm float-right\">\n                  <EditOutlined className=\"text-warning\" />\n                </span>\n              </Link>\n            </div>\n          ))}\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport default SubCreate;\n"]},"metadata":{},"sourceType":"module"}