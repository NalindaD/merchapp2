{"ast":null,"code":"import{jsxs as _jsxs}from\"react/jsx-runtime\";import{jsx as _jsx}from\"react/jsx-runtime\";import _objectSpread from\"F:/mern/udemy/ecommerce/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _slicedToArray from\"F:/mern/udemy/ecommerce/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useEffect,useState}from\"react\";import{getProduct,productStar}from\"../functions/product\";import SingleProduct from\"../components/cards/SingleProduct\";import{useSelector}from\"react-redux\";import{getRelated}from\"../functions/product\";import ProductCard from\"../components/cards/ProductCard\";var Product=function Product(_ref){var match=_ref.match;var _useState=useState({}),_useState2=_slicedToArray(_useState,2),product=_useState2[0],setProduct=_useState2[1];var _useState3=useState([]),_useState4=_slicedToArray(_useState3,2),related=_useState4[0],setRelated=_useState4[1];var _useState5=useState(0),_useState6=_slicedToArray(_useState5,2),star=_useState6[0],setStar=_useState6[1];// redux\nvar _useSelector=useSelector(function(state){return _objectSpread({},state);}),user=_useSelector.user;var slug=match.params.slug;useEffect(function(){loadSingleProduct();},[slug]);useEffect(function(){if(product.ratings&&user){var existingRatingObject=product.ratings.find(function(ele){return ele.postedBy.toString()===user._id.toString();});existingRatingObject&&setStar(existingRatingObject.star);// current user's star\n}});var loadSingleProduct=function loadSingleProduct(){getProduct(slug).then(function(res){setProduct(res.data);// load related\ngetRelated(res.data._id).then(function(res){return setRelated(res.data);});});};var onStarClick=function onStarClick(newRating,name){setStar(newRating);console.table(newRating,name);productStar(name,newRating,user.token).then(function(res){console.log(\"rating clicked\",res.data);loadSingleProduct();// if you want to show updated rating in real time\n});};return/*#__PURE__*/_jsxs(\"div\",{className:\"container-fluid\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"row pt-4\",children:/*#__PURE__*/_jsx(SingleProduct,{product:product,onStarClick:onStarClick,star:star})}),/*#__PURE__*/_jsx(\"div\",{className:\"row\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"col text-center pt-5 pb-5\",children:[/*#__PURE__*/_jsx(\"hr\",{}),/*#__PURE__*/_jsx(\"h4\",{children:\"Related Products\"}),/*#__PURE__*/_jsx(\"hr\",{})]})}),/*#__PURE__*/_jsx(\"div\",{className:\"row pb-5\",children:related.length?related.map(function(r){return/*#__PURE__*/_jsx(\"div\",{className:\"col-md-4\",children:/*#__PURE__*/_jsx(ProductCard,{product:r})},r._id);}):/*#__PURE__*/_jsx(\"div\",{className:\"text-center col\",children:\"No Products Found\"})})]});};export default Product;","map":{"version":3,"sources":["F:/mern/udemy/ecommerce/client/src/pages/Product.js"],"names":["React","useEffect","useState","getProduct","productStar","SingleProduct","useSelector","getRelated","ProductCard","Product","match","product","setProduct","related","setRelated","star","setStar","state","user","slug","params","loadSingleProduct","ratings","existingRatingObject","find","ele","postedBy","toString","_id","then","res","data","onStarClick","newRating","name","console","table","token","log","length","map","r"],"mappings":"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","sourcesContent":["import React, { useEffect, useState } from \"react\";\nimport { getProduct, productStar } from \"../functions/product\";\nimport SingleProduct from \"../components/cards/SingleProduct\";\nimport { useSelector } from \"react-redux\";\nimport { getRelated } from \"../functions/product\";\nimport ProductCard from \"../components/cards/ProductCard\";\n\nconst Product = ({ match }) => {\n  const [product, setProduct] = useState({});\n  const [related, setRelated] = useState([]);\n  const [star, setStar] = useState(0);\n  // redux\n  const { user } = useSelector((state) => ({ ...state }));\n\n  const { slug } = match.params;\n\n  useEffect(() => {\n    loadSingleProduct();\n  }, [slug]);\n\n  useEffect(() => {\n    if (product.ratings && user) {\n      let existingRatingObject = product.ratings.find(\n        (ele) => ele.postedBy.toString() === user._id.toString()\n      );\n      existingRatingObject && setStar(existingRatingObject.star); // current user's star\n    }\n  });\n\n  const loadSingleProduct = () => {\n    getProduct(slug).then((res) => {\n      setProduct(res.data);\n      // load related\n      getRelated(res.data._id).then((res) => setRelated(res.data));\n    });\n  };\n\n  const onStarClick = (newRating, name) => {\n    setStar(newRating);\n    console.table(newRating, name);\n    productStar(name, newRating, user.token).then((res) => {\n      console.log(\"rating clicked\", res.data);\n      loadSingleProduct(); // if you want to show updated rating in real time\n    });\n  };\n\n  return (\n    <div className=\"container-fluid\">\n      <div className=\"row pt-4\">\n        <SingleProduct\n          product={product}\n          onStarClick={onStarClick}\n          star={star}\n        />\n      </div>\n\n      <div className=\"row\">\n        <div className=\"col text-center pt-5 pb-5\">\n          <hr />\n          <h4>Related Products</h4>\n          <hr />\n        </div>\n      </div>\n\n      <div className=\"row pb-5\">\n        {related.length ? (\n          related.map((r) => (\n            <div key={r._id} className=\"col-md-4\">\n              <ProductCard product={r} />\n            </div>\n          ))\n        ) : (\n          <div className=\"text-center col\">No Products Found</div>\n        )}\n      </div>\n    </div>\n  );\n};\n\nexport default Product;\n"]},"metadata":{},"sourceType":"module"}