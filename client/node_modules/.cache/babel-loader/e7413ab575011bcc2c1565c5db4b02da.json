{"ast":null,"code":"import{jsxs as _jsxs}from\"react/jsx-runtime\";import{jsx as _jsx}from\"react/jsx-runtime\";import _slicedToArray from\"F:/mern/udemy/ecommerce/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import _objectSpread from\"F:/mern/udemy/ecommerce/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import React,{useState,useEffect}from\"react\";import AdminNav from\"../../../components/nav/AdminNav\";import{toast}from\"react-toastify\";import{useSelector}from\"react-redux\";import{getCategories}from\"../../../functions/category\";import{updateSub,getSub}from\"../../../functions/sub\";import{Link}from\"react-router-dom\";import{EditOutlined,DeleteOutlined}from\"@ant-design/icons\";import CategoryForm from\"../../../components/forms/CategoryForm\";import LocalSearch from\"../../../components/forms/LocalSearch\";var SubUpdate=function SubUpdate(_ref){var match=_ref.match,history=_ref.history;var _useSelector=useSelector(function(state){return _objectSpread({},state);}),user=_useSelector.user;var _useState=useState(\"\"),_useState2=_slicedToArray(_useState,2),name=_useState2[0],setName=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),loading=_useState4[0],setLoading=_useState4[1];var _useState5=useState([]),_useState6=_slicedToArray(_useState5,2),categories=_useState6[0],setCategories=_useState6[1];var _useState7=useState(\"\"),_useState8=_slicedToArray(_useState7,2),parent=_useState8[0],setParent=_useState8[1];useEffect(function(){loadCategories();loadSub();},[]);var loadCategories=function loadCategories(){return getCategories().then(function(c){return setCategories(c.data);});};var loadSub=function loadSub(){return getSub(match.params.slug).then(function(s){setName(s.data.name);setParent(s.data.parent);});};var handleSubmit=function handleSubmit(e){e.preventDefault();// console.log(name);\nsetLoading(true);updateSub(match.params.slug,{name:name,parent:parent},user.token).then(function(res){// console.log(res)\nsetLoading(false);setName(\"\");toast.success(\"\\\"\".concat(res.data.name,\"\\\" is updated\"));history.push(\"/admin/sub\");}).catch(function(err){console.log(err);setLoading(false);if(err.response.status===400)toast.error(err.response.data);});};return/*#__PURE__*/_jsx(\"div\",{className:\"container-fluid\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"row\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"col-md-2\",children:/*#__PURE__*/_jsx(AdminNav,{})}),/*#__PURE__*/_jsxs(\"div\",{className:\"col\",children:[loading?/*#__PURE__*/_jsx(\"h4\",{className:\"text-danger\",children:\"Loading..\"}):/*#__PURE__*/_jsx(\"h4\",{children:\"Update sub category\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Parent category\"}),/*#__PURE__*/_jsxs(\"select\",{name:\"category\",className:\"form-control\",onChange:function onChange(e){return setParent(e.target.value);},children:[/*#__PURE__*/_jsx(\"option\",{children:\"Please select\"}),categories.length>0&&categories.map(function(c){return/*#__PURE__*/_jsx(\"option\",{value:c._id,selected:c._id===parent,children:c.name},c._id);})]})]}),/*#__PURE__*/_jsx(CategoryForm,{handleSubmit:handleSubmit,name:name,setName:setName})]})]})});};export default SubUpdate;","map":{"version":3,"sources":["F:/mern/udemy/ecommerce/client/src/pages/admin/sub/SubUpdate.js"],"names":["React","useState","useEffect","AdminNav","toast","useSelector","getCategories","updateSub","getSub","Link","EditOutlined","DeleteOutlined","CategoryForm","LocalSearch","SubUpdate","match","history","state","user","name","setName","loading","setLoading","categories","setCategories","parent","setParent","loadCategories","loadSub","then","c","data","params","slug","s","handleSubmit","e","preventDefault","token","res","success","push","catch","err","console","log","response","status","error","target","value","length","map","_id"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from \"react\";\nimport AdminNav from \"../../../components/nav/AdminNav\";\nimport { toast } from \"react-toastify\";\nimport { useSelector } from \"react-redux\";\nimport { getCategories } from \"../../../functions/category\";\nimport { updateSub, getSub } from \"../../../functions/sub\";\nimport { Link } from \"react-router-dom\";\nimport { EditOutlined, DeleteOutlined } from \"@ant-design/icons\";\nimport CategoryForm from \"../../../components/forms/CategoryForm\";\nimport LocalSearch from \"../../../components/forms/LocalSearch\";\n\nconst SubUpdate = ({ match, history }) => {\n  const { user } = useSelector((state) => ({ ...state }));\n\n  const [name, setName] = useState(\"\");\n  const [loading, setLoading] = useState(false);\n  const [categories, setCategories] = useState([]);\n  const [parent, setParent] = useState(\"\");\n\n  useEffect(() => {\n    loadCategories();\n    loadSub();\n  }, []);\n\n  const loadCategories = () =>\n    getCategories().then((c) => setCategories(c.data));\n\n  const loadSub = () =>\n    getSub(match.params.slug).then((s) => {\n      setName(s.data.name);\n      setParent(s.data.parent);\n    });\n\n  const handleSubmit = (e) => {\n    e.preventDefault();\n    // console.log(name);\n    setLoading(true);\n    updateSub(match.params.slug, { name, parent }, user.token)\n      .then((res) => {\n        // console.log(res)\n        setLoading(false);\n        setName(\"\");\n        toast.success(`\"${res.data.name}\" is updated`);\n        history.push(\"/admin/sub\");\n      })\n      .catch((err) => {\n        console.log(err);\n        setLoading(false);\n        if (err.response.status === 400) toast.error(err.response.data);\n      });\n  };\n\n  return (\n    <div className=\"container-fluid\">\n      <div className=\"row\">\n        <div className=\"col-md-2\">\n          <AdminNav />\n        </div>\n        <div className=\"col\">\n          {loading ? (\n            <h4 className=\"text-danger\">Loading..</h4>\n          ) : (\n            <h4>Update sub category</h4>\n          )}\n\n          <div className=\"form-group\">\n            <label>Parent category</label>\n            <select\n              name=\"category\"\n              className=\"form-control\"\n              onChange={(e) => setParent(e.target.value)}\n            >\n              <option>Please select</option>\n              {categories.length > 0 &&\n                categories.map((c) => (\n                  <option key={c._id} value={c._id} selected={c._id === parent}>\n                    {c.name}\n                  </option>\n                ))}\n            </select>\n          </div>\n\n          <CategoryForm\n            handleSubmit={handleSubmit}\n            name={name}\n            setName={setName}\n          />\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport default SubUpdate;\n"]},"metadata":{},"sourceType":"module"}